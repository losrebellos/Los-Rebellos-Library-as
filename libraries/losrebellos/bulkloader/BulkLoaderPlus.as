package losrebellos.bulkloader {	import br.com.stimuli.loading.BulkLoader;	import br.com.stimuli.loading.loadingtypes.URLItem;	import losrebellos.console.Console;	import losrebellos.display.BitmapPlus;	import flash.display.Bitmap;	import flash.display.BitmapData;	import flash.display.Loader;	import flash.display.MovieClip;	import flash.system.ApplicationDomain;	import flash.utils.ByteArray;	/*	 *	 * @author los rebellos	 *	 */	public class BulkLoaderPlus extends BulkLoader 	{		/*		 * 		 * TYPES		 * 		 */		public static const TYPE_CSS:String = "css";						/*		 * 		 * CONSTRUCTOR		 * 		 */		public function BulkLoaderPlus(name:String, numConnections:int = BulkLoader.DEFAULT_NUM_CONNECTIONS, logLevel:int = BulkLoader.DEFAULT_LOG_LEVEL)		{			super(name, numConnections, logLevel);						//change output			this.logFunction = Console.simpleOutput;						//register special types			BulkLoader.registerNewType(TYPE_CSS, TYPE_CSS, URLItem);		}				/*		 * 		 * CONTROLS		 * 		 */		public function stop():void		{			this.pauseAll();		}		public function dispose():void		{			stop();			this.removeAll();		}						/*		 * 		 * BYTEARRAY		 * 		 */		public function getByteArray(key:String, clearMemory:Boolean = false):ByteArray		{			var mc:MovieClip = this.getMovieClip(key, clearMemory);			if(mc)				return mc.loaderInfo.bytes;						return null;		}						/*		 * 		 * CLASSES		 * 		 */		public function getApplicationDomain(id:String):ApplicationDomain		{			var mc:MovieClip = this.getMovieClip(id);			if(mc)			{				var loader:Loader = mc.loaderInfo.loader;				return loader.contentLoaderInfo.applicationDomain;			}						return null;		}		public function getClass(id:String, name:String):Class		{			var mc:MovieClip = this.getMovieClip(id);			if(mc)			{				var loader:Loader = mc.loaderInfo.loader;				var app:ApplicationDomain = loader.contentLoaderInfo.applicationDomain;							try				{					return app.getDefinition(name) as Class;				}				catch(e:*)				{					Console.output(this, "no Class [" + name + "] in assets file: " + id);				}			}			else				Console.output(this, id + " is not loaded or is not a SWF");						return null;		}		public function getClassInstance(id:String, name:String):*		{			var c:Class = this.getClass(id, name);			return new c;		}		public function getClassInstanceAs(id:String, name:String, c:Class):*		{			return getClassInstance(id, name) as c;		}						/*		 * 		 * IMAGE		 * 		 */		public function getBitmapDataFromClass(id:String, name:String, w:Number, h:Number):BitmapData		{			var c:Class = this.getClass(id, name);			return new c(w, h) as BitmapData;		}		public function getBitmapFromClass(id:String, name:String, w:Number, h:Number):Bitmap		{			return new Bitmap(getBitmapDataFromClass(id, name, w, h));		}		public function getBitmapPlusFromClass(id:String, name:String, w:Number, h:Number):BitmapPlus		{			return new BitmapPlus(getBitmapDataFromClass(id, name, w, h));		}						/*		 * 		 * REMOVE		 * 		 */		public function removeUnloadedItems():void		{			this.removePausedItems();			this.removeFailedItems();		}	}}