package com.losrebellos.project.framework.base.application
{
	import com.losrebellos.project.framework.base.application.preloader.IApplicationPreloader;
	import com.losrebellos.project.framework.base.mvcs.IViewContainer;

	import flash.display.StageAlign;
	import flash.display.StageScaleMode;
	import flash.events.Event;


	/**
	 * @author Benoit vinay - ben@benoitvinay.com
	 */
	public class SimpleApplication extends AbstractApplication implements IViewContainer, IApplication
	{
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// CONSTRUCTOR
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		public function SimpleApplication()
		{
			super();
		}
		
		
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// STAGE
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		override protected function createStageOptions():void
		{
			stage.align = StageAlign.TOP_LEFT;
			stage.scaleMode = StageScaleMode.NO_SCALE;
			
			stage.addEventListener(Event.RESIZE, onResize, false, 0, true);
			stage.addEventListener(Event.RENDER, onRender, false, 0, true);
		}
		
		
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// START APPLICATION
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		override protected function onAddedToStage(e:Event):void
		{
			removeEventListener(Event.ADDED_TO_STAGE, onAddedToStage);
			
			setupSecurity();
			createStageOptions();
			createContent();
			onResize();
			enable();
		}
		
		
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// STOP APPLICATION
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		override protected function onRemovedFromStage(e:Event):void
		{
			removeEventListener(Event.REMOVED_FROM_STAGE, onRemovedFromStage);
			
			disable();
			disposeContent();
			dispose(e);
		}
		
		
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// PRELOADER
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		protected var _preloader:IApplicationPreloader;
		override public function set preloader(value:IApplicationPreloader):void
		{
			_preloader = value;
		}
		
		
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// INVALIDATE
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		override protected function onResize(e:Event = null):void
		{
			resize();
		}
		override protected function onRender(e:Event = null):void
		{
			render();
		}
	}
}